version: "3.9"

networks:
  public:
  internal:
    internal: true   # ğŸ” NOT accessible from host

services:
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"       # ğŸŒ ONLY public entry point
    networks:
      - public
      - internal
    depends_on:
      - api

  api:
    build: ./api
    container_name: node-api
    networks:
      - internal     # ğŸ”’ internal only
    environment:
      - OLLAMA_URL=http://ollama:11434

  ollama:
    image: ollama/ollama
    container_name: ollama
    networks:
      - internal     # ğŸ”’ internal only
